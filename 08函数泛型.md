éå¸¸å¥½ ğŸ‘ï¼Œä½ é—®çš„ **Dart å‡½æ•°æ³›å‹ï¼ˆGeneric Functionsï¼‰** æ˜¯ Dart æ³›å‹ä½“ç³»ä¸­éå¸¸å®ç”¨çš„éƒ¨åˆ†ï¼Œå°¤å…¶åœ¨å°è£…å·¥å…·æ–¹æ³•ã€ç½‘ç»œè¯·æ±‚å°è£…ã€æ•°æ®ç±»å‹è½¬æ¢ç­‰åœºæ™¯ä¸­ã€‚
ä¸‹é¢æˆ‘å°†ç³»ç»Ÿåœ°ã€è¯¦ç»†åœ°è®²è§£ Dart å‡½æ•°æ³›å‹çš„å…¨éƒ¨æ ¸å¿ƒçŸ¥è¯†ï¼Œå¹¶ç»“åˆ**ç»å…¸æ¡ˆä¾‹ + å®æˆ˜ç¤ºä¾‹ + è®²è§£æ³¨é‡Š**ï¼Œè®©ä½ å½»åº•æŒæ¡ã€‚

---

## ğŸŒ± ä¸€ã€ä»€ä¹ˆæ˜¯å‡½æ•°æ³›å‹ï¼ˆGeneric Functionsï¼‰

> æ³›å‹å‡½æ•°ï¼šå…è®¸å‡½æ•°åœ¨å®šä¹‰æ—¶ä¸æŒ‡å®šå…·ä½“ç±»å‹ï¼Œè€Œåœ¨**è°ƒç”¨æ—¶**å†ç¡®å®šç±»å‹çš„ä¸€ç§æœºåˆ¶ã€‚

ğŸ‘‰ å®ƒè®©å‡½æ•°å¯ä»¥**â€œç±»å‹å‚æ•°åŒ–â€**ï¼Œä»è€Œåœ¨ä¿æŒç±»å‹å®‰å…¨çš„å‰æä¸‹å†™å‡ºæ›´çµæ´»çš„ä»£ç ã€‚

---

## ğŸŒ° äºŒã€æœ€ç®€å•çš„æ³›å‹å‡½æ•°ç¤ºä¾‹

### ğŸ”¹ æ²¡æœ‰æ³›å‹çš„ç‰ˆæœ¬

```dart
T echo(T value) {
  return value;
}
```

### ğŸ”¹ æ³›å‹çš„ç‰ˆæœ¬

```dart
T echo<T>(T value) {
  return value;
}

void main() {
  print(echo<int>(123));     // è¾“å‡º 123
  print(echo<String>('Hi')); // è¾“å‡º Hi
}
```

âœ… **è§£é‡Šï¼š**

* `<T>` æ˜¯ç±»å‹å‚æ•°ã€‚
* `T` å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚
* åœ¨è°ƒç”¨ `echo` æ—¶ï¼Œä½ å¯ä»¥æ˜¾å¼åœ°ä¼ ç±»å‹ï¼ˆ`echo<int>`ï¼‰ï¼Œä¹Ÿå¯ä»¥è®© Dart è‡ªåŠ¨æ¨æ–­ã€‚

---

## ğŸ¯ ä¸‰ã€å¤šä¸ªæ³›å‹å‚æ•°çš„å‡½æ•°

æœ‰æ—¶ä¸€ä¸ªå‡½æ•°ä¼šå¤„ç†ä¸¤ä¸ªä¸åŒç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ Map è½¬æ¢ã€‚

```dart
Map<K, V> createMap<K, V>(K key, V value) {
  return {key: value};
}

void main() {
  print(createMap<String, int>('age', 20)); // {age: 20}
  print(createMap<int, String>(1, 'Tom')); // {1: Tom}
}
```

âœ… **è§£é‡Šï¼š**

* `<K, V>` è¡¨ç¤ºæœ‰ä¸¤ä¸ªæ³›å‹å‚æ•°ã€‚
* è¿™ç§å†™æ³•å¸¸å‡ºç°åœ¨é›†åˆæ“ä½œæˆ–ç½‘ç»œå±‚æ•°æ®è½¬æ¢ã€‚

---

## ğŸ§± å››ã€æ³›å‹å‡½æ•° + é›†åˆæ“ä½œ

Dart çš„ `List<T>`ã€`Map<K, V>` æœ¬èº«å°±æ˜¯æ³›å‹ç±»å‹ã€‚
æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°ä¸­æ¥æ”¶æ³›å‹é›†åˆå¹¶åšæ“ä½œã€‚

### ç¤ºä¾‹ 1ï¼šæ‰“å°ä»»ä½•ç±»å‹çš„ List å…ƒç´ 

```dart
void printList<T>(List<T> items) {
  for (var item in items) {
    print(item);
  }
}

void main() {
  printList<int>([1, 2, 3]);
  printList<String>(['a', 'b', 'c']);
}
```

### ç¤ºä¾‹ 2ï¼šè¿‡æ»¤åˆ—è¡¨ï¼ˆç±»å‹å®‰å…¨ï¼‰

```dart
List<T> filterList<T>(List<T> items, bool Function(T) test) {
  List<T> result = [];
  for (var item in items) {
    if (test(item)) result.add(item);
  }
  return result;
}

void main() {
  var numbers = [1, 2, 3, 4, 5];
  var even = filterList(numbers, (n) => n.isEven);
  print(even); // [2, 4]
}
```

âœ… **è§£é‡Šï¼š**

* æ³›å‹å‡½æ•° `filterList` æ¥æ”¶ `List<T>`ï¼Œè¿”å›åŒç±»å‹ `List<T>`ã€‚
* `bool Function(T)` æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¥æ”¶ç±»å‹ä¸º `T` çš„å…ƒç´ ã€‚

---

## ğŸ§© äº”ã€æ³›å‹å‡½æ•° + Class ç»“åˆï¼ˆé«˜çº§ç”¨æ³•ï¼‰

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé€šç”¨çš„ç½‘ç»œè§£æå‡½æ•°ï¼š

```dart
T parseResponse<T>(String jsonStr, T Function(Map<String, dynamic>) fromJson) {
  var json = {'name': 'Tom', 'age': 20}; // æ¨¡æ‹Ÿ JSON æ•°æ®
  return fromJson(json);
}

class User {
  String name;
  int age;
  User(this.name, this.age);

  factory User.fromJson(Map<String, dynamic> json) {
    return User(json['name'], json['age']);
  }

  @override
  String toString() => 'User(name: $name, age: $age)';
}

void main() {
  var user = parseResponse<User>('{}', (data) => User.fromJson(data));
  print(user); // User(name: Tom, age: 20)
}
```

âœ… **è®²è§£ï¼š**

* æ³›å‹ `T` ç”¨äºæŒ‡å®šå‡½æ•°è¿”å›çš„æ•°æ®æ¨¡å‹ç±»å‹ã€‚
* å‡½æ•°å†…éƒ¨å®Œå…¨ä¸çŸ¥é“ `T` æ˜¯ä»€ä¹ˆç±»å‹ï¼Œç”±è°ƒç”¨æ–¹å†³å®šã€‚
* è¿™åœ¨ **ç½‘ç»œå±‚ JSON â†’ æ¨¡å‹å¯¹è±¡** è½¬æ¢ä¸­éå¸¸å¸¸è§ã€‚

---

## âš™ï¸ å…­ã€æ³›å‹å‡½æ•° + ç±»å‹çº¦æŸï¼ˆextendsï¼‰

æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›æ³›å‹ç±»å‹å¿…é¡»ç»§æ‰¿è‡ªæŸä¸ªç±»æˆ–å®ç°æŸä¸ªæ¥å£ã€‚
å¯ä»¥ä½¿ç”¨ `extends` å…³é”®å­—æ¥é™åˆ¶ç±»å‹èŒƒå›´ã€‚

### ä¾‹å­ï¼š

```dart
class Animal {
  void speak() => print("Animal speaks");
}

class Dog extends Animal {
  @override
  void speak() => print("Dog barks");
}

void makeSpeak<T extends Animal>(T animal) {
  animal.speak();
}

void main() {
  makeSpeak(Dog());     // Dog barks
  makeSpeak(Animal());  // Animal speaks
  // makeSpeak(123); // âŒ é”™è¯¯ï¼Œint ä¸æ˜¯ Animal å­ç±»
}
```

âœ… **è§£é‡Šï¼š**

* `<T extends Animal>` é™å®šäº†ç±»å‹ T å¿…é¡»æ˜¯ `Animal` æˆ–å…¶å­ç±»ã€‚
* å‡½æ•°å†…éƒ¨å¯ç›´æ¥è°ƒç”¨ `Animal` çš„æ–¹æ³•ã€‚

---

## ğŸ§  ä¸ƒã€æ³›å‹ + Future å¼‚æ­¥å‡½æ•°ï¼ˆå¸¸è§äºç½‘ç»œå°è£…ï¼‰

### ç¤ºä¾‹ï¼šé€šç”¨è¯·æ±‚å‡½æ•°

```dart
Future<T> fetchData<T>(Future<Map<String, dynamic>> Function() apiCall, T Function(Map<String, dynamic>) fromJson) async {
  final data = await apiCall(); // æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚
  return fromJson(data);
}

class Product {
  final String name;
  final double price;

  Product(this.name, this.price);

  factory Product.fromJson(Map<String, dynamic> json) {
    return Product(json['name'], json['price']);
  }

  @override
  String toString() => 'Product(name: $name, price: $price)';
}

void main() async {
  final api = () async => {'name': 'Laptop', 'price': 9999.99};

  var product = await fetchData<Product>(api, (data) => Product.fromJson(data));
  print(product); // Product(name: Laptop, price: 9999.99)
}
```

âœ… **å¸¸è§äºï¼š**

* Flutter ç½‘ç»œå°è£…ä¸­ï¼ˆDioã€httpï¼‰
* æ•°æ®å±‚ç»Ÿä¸€è§£æå‡½æ•°
* JSON â†’ Model è½¬æ¢

---

## ğŸ§® å…«ã€æ³›å‹å‡½æ•° + å·¥å…·æ–¹æ³•å°è£…ï¼ˆå®æˆ˜æ¡ˆä¾‹ï¼‰

å‡è®¾ä½ å†™ä¸€ä¸ªé€šç”¨çš„åˆ—è¡¨è½¬æ¢å·¥å…·ï¼š

```dart
List<R> mapList<T, R>(List<T> items, R Function(T) convert) {
  return items.map(convert).toList();
}

void main() {
  var numbers = [1, 2, 3];
  var strings = mapList(numbers, (n) => 'No.$n');
  print(strings); // ['No.1', 'No.2', 'No.3']
}
```

âœ… **ç”¨é€”ï¼š**

* å°†ä»»ä½•ç±»å‹çš„åˆ—è¡¨è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚
* ç±»ä¼¼ JavaScript ä¸­çš„ `map()`ï¼Œä½† Dart æ³›å‹è®©å®ƒç±»å‹å®‰å…¨ã€‚

---

## ğŸ’ ä¹ã€å®Œæ•´æ€»ç»“ï¼ˆå‡½æ•°æ³›å‹æ€ç»´å¯¼å›¾ï¼‰

| åŠŸèƒ½          | ç¤ºä¾‹                   | è¯´æ˜        |
| ----------- | -------------------- | --------- |
| å•æ³›å‹å‚æ•°       | `T echo<T>(T value)` | æœ€åŸºç¡€å†™æ³•     |
| å¤šæ³›å‹å‚æ•°       | `<K, V>`             | å¸¸ç”¨äº Map   |
| æ³›å‹é›†åˆæ“ä½œ      | `<T>`                | å¦‚è¿‡æ»¤ã€æ’åº    |
| æ³›å‹ + å›è°ƒ     | `Function(T)`        | é«˜é˜¶å‡½æ•°      |
| æ³›å‹çº¦æŸ        | `<T extends Base>`   | é™åˆ¶ç±»å‹èŒƒå›´    |
| æ³›å‹ + Future | `Future<T>`          | å¼‚æ­¥ç½‘ç»œå°è£…    |
| æ³›å‹ + Class  | `<T>(fromJson)`      | JSONè½¬æ¨¡å‹   |
| æ³›å‹ + å·¥å…·å‡½æ•°   | `<T, R>`             | ç±»å‹å®‰å…¨çš„è½¬æ¢å·¥å…· |

---

## ğŸ§  åã€ç»ƒä¹ å»ºè®®ï¼ˆå¼ºåŒ–å­¦ä¹ ï¼‰

å»ºè®®ä½ å°è¯•è‡ªå·±åŠ¨æ‰‹å†™ä»¥ä¸‹å°ç»ƒä¹ ï¼š

1. âœ… å†™ä¸€ä¸ª `swap<T>(List<T> list, int i, int j)` äº¤æ¢åˆ—è¡¨å…ƒç´ çš„æ³›å‹å‡½æ•°ã€‚
2. âœ… å†™ä¸€ä¸ª `firstWhereOrNull<T>(List<T> list, bool Function(T) test)`ï¼Œè¿”å›æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚
3. âœ… å†™ä¸€ä¸ª `convertList<T, R>(List<T> source, R Function(T) converter)`ï¼Œå®ç°ç±»å‹å®‰å…¨è½¬æ¢ã€‚

---

æ˜¯å¦å¸Œæœ›æˆ‘æ¥ä¸‹æ¥å¸®ä½ å†™ä¸€ä¸ª
ğŸ‘‰ **å¸¦å®Œæ•´æ³¨é‡Šã€æ§åˆ¶å°å¯è¿è¡Œçš„ Dart æ³›å‹å·¥å…·å‡½æ•°å®æˆ˜æ–‡ä»¶**
ï¼ˆæ¯”å¦‚å°è£… `filterList`ã€`mapList`ã€`parseResponse` ç­‰å‡½æ•°åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼‰ï¼Ÿ
æˆ‘å¯ä»¥å¸®ä½ å†™æˆä¸€ä¸ªâ€œDart æ³›å‹å‡½æ•°å·¥å…·åº“â€å®æˆ˜æ¨¡æ¿ã€‚
