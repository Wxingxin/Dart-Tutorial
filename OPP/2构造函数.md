# 💯💯💯 一、构造函数的作用是什么？

在 Dart 中，**构造函数（Constructor）** 的作用就是：

> ✅ 当你“创建对象”的时候，**自动执行一些初始化操作**。

---

### 🧩 举个例子：

```dart
class Person {
  String name = '未命名';
  int age = 0;

  void sayHello() {
    print('你好，我是$name，今年$age岁');
  }
}

void main() {
  var p = Person(); // 创建对象
  p.sayHello();     // 输出：你好，我是未命名，今年0岁
}
```

这里的 `Person()` 就是调用了 **构造函数**。
但你会发现：我们**并没有写**任何构造函数，它却能正常工作。

---

# 💯💯💯 默认构造函数

## Dart 自动提供的“默认构造函数”

当你没有自己定义构造函数时，Dart 会**自动生成一个无参数的默认构造函数**。

它的形式等价于 👇：

```dart
class Person {
  String name = '未命名';
  int age = 0;

  // Dart 自动帮你加上这个 ↓
  Person() {
    // 空的，没有参数，也没有操作
  }
}
```

也就是说，这个默认构造函数：

- 名字和类名相同（`Person()`）
- 没有参数
- 什么也不做（不初始化额外内容）
- 会被 Dart 自动创建

---

## 🧠 三、默认构造函数的作用（总结）

| 功能       | 说明                                |
| ---------- | ----------------------------------- |
| 创建对象   | 用于生成类的实例（对象）            |
| 初始化属性 | 若类中有默认值，会在构造时设置      |
| 自动调用   | 每次 `var p = Person();` 时自动调用 |
| 可替换     | 你可以自己定义构造函数来替换默认的  |

---

## 🧰 四、验证默认构造函数的存在

你可以加上 `print()` 验证它在运行时会被执行 👇

```dart
class Person {
  String name = '小明';
  int age = 18;

  // 显式写出默认构造函数
  Person() {
    print('构造函数被调用');
  }
}

void main() {
  var p1 = Person(); // 输出：构造函数被调用
  print('${p1.name} - ${p1.age}');
}
```

📎 输出结果：

```
构造函数被调用
小明 - 18
```

说明：在创建对象的那一刻，Dart 自动执行了构造函数。

---

# 💯💯💯 带参数构造函数

一旦你**自己定义了构造函数**，
Dart 就不会再自动生成那个“默认构造函数”。

举个例子：

```dart
class Person {
  String name;
  int age;

  // 自定义构造函数
  Person(this.name, this.age);
}

void main() {
  var p = Person('小红', 20); // ✅ 必须传参数
  // var p2 = Person(); ❌ 报错：因为默认构造函数没了
}
```

🧠 **重点记忆：**

- Dart 自动提供的“默认构造函数”仅在你**没有定义任何构造函数**时才存在。
- 一旦定义了自己的构造函数，**自动的那个就不再生成**。

---

## 🎯 小结复习卡片

| 概念         | 内容                                   |
| ------------ | -------------------------------------- |
| 构造函数     | 创建对象时执行，用来初始化属性         |
| 默认构造函数 | 无参数、空实现，由 Dart 自动提供       |
| 自动调用     | 每次创建对象时自动运行                 |
| 被替换       | 一旦你写了自己的构造函数，默认的就消失 |

# 💯💯💯 语法糖构造函数（this）

非常好 👍
你现在学习到了 Dart 构造函数中最常用、最简洁的一种形式：

> 🍬 **语法糖构造函数（this 构造函数）**

它是所有 Dart 程序员都会用的写法，非常高效、简洁。
我们来一步步讲清楚它的概念、语法、原理、注意点和使用场景。

---

## 🧭 一、什么是语法糖构造函数？

**语法糖（Syntactic Sugar）** 指的是一种让代码写起来更方便的语法形式。

在 Dart 中，语法糖构造函数就是：

> 使用 `this.xxx` 的形式来 **直接将参数赋值给类的同名属性**。

---

## 🧩 二、普通写法 vs 语法糖写法

先看「普通构造函数」写法：

```dart
class Person {
  String name;
  int age;

  Person(String name, int age) {
    this.name = name;
    this.age = age;
  }
}
```

⚙️ 这段代码完全合法，但有明显的重复：

* 参数名和属性名重复。
* `this.name = name` 显得啰嗦。

---

### ✅ 使用语法糖后

我们可以简化为：

```dart
class Person {
  String name;
  int age;

  Person(this.name, this.age);
}
```

🧠 含义相同！
Dart 自动帮你把构造参数和类属性“绑定”在一起。

---

## 🧪 三、完整示例

```dart
class Person {
  String name;
  int age;

  // 使用语法糖构造函数
  Person(this.name, this.age);

  void sayHello() {
    print('你好，我是$name，今年$age岁');
  }
}

void main() {
  var p = Person('小明', 18); // 创建对象时直接传值
  p.sayHello();
}
```

输出：

```
你好，我是小明，今年18岁
```

---

## 🧠 四、语法糖构造函数的特点

| 特点       | 说明                    |
| -------- | --------------------- |
| 简洁       | 不用写 `this.xxx = xxx;` |
| 自动赋值     | Dart 自动把构造参数赋值给同名属性   |
| 支持多个参数   | 可以写任意数量的 `this.xxx`   |
| 只作用在同名属性 | 参数名必须和属性名相同           |
| 可以混合普通参数 | 语法糖参数和普通参数可以共存        |

---

## 🧮 五、可以混合使用

你可以在语法糖参数之外，加普通参数逻辑：

```dart
class Student {
  String name;
  int age;
  String grade;

  Student(this.name, this.age, [this.grade = '未知']);
}

void main() {
  var s1 = Student('小红', 16);
  var s2 = Student('小亮', 17, '高一');

  print('${s1.name} - ${s1.grade}');
  print('${s2.name} - ${s2.grade}');
}
```

输出：

```
小红 - 未知
小亮 - 高一
```

✅ Dart 语法糖与可选参数 (`[]`、`{}`) 也能搭配使用。

---

## 💡 六、与命名参数结合使用（更常见）

Dart 常用的构造函数写法是**命名参数 + 语法糖**的组合：

```dart
class User {
  String name;
  int age;

  User({this.name = '未命名', this.age = 0});
}

void main() {
  var u1 = User(); // 使用默认值
  var u2 = User(name: '小蓝', age: 22);

  print('${u1.name} - ${u1.age}');
  print('${u2.name} - ${u2.age}');
}
```

输出：

```
未命名 - 0
小蓝 - 22
```

✅ **这种写法在 Flutter 中极其常见**（例如：`Text(this.text, {this.style})`）。

---

## ⚠️ 七、语法糖构造函数的限制

| 限制             | 说明                                |
| -------------- | --------------------------------- |
| 参数名必须和属性名相同    | 否则无法自动赋值                          |
| 不能包含额外逻辑       | 只能做赋值，不能做计算                       |
| 若有复杂逻辑需用普通构造函数 | 比如：`age = a > 0 ? a : 0` 必须写成普通形式 |

例如：

```dart
// ❌ 错误写法：语法糖不能做判断
Person(this.name, this.age > 0 ? this.age : 0);

// ✅ 正确写法：
Person(String name, int age) {
  this.name = name;
  this.age = age > 0 ? age : 0;
}
```

---

## 🧭 八、小结表格

| 分类   | 普通构造函数            | 语法糖构造函数     |
| ---- | ----------------- | ----------- |
| 写法   | `this.xxx = xxx;` | `this.xxx`  |
| 简洁性  | 啰嗦                | ✅ 简洁        |
| 逻辑支持 | 可写判断、运算等          | ❌ 仅赋值       |
| 推荐场景 | 需要复杂初始化逻辑时        | ✅ 普通对象赋值初始化 |

---

## 🧱 九、练习建议

1. ✍️ 写一个 `Car` 类，属性 `brand`、`price`，用语法糖构造函数初始化。
2. ✍️ 写一个 `Book` 类，用命名参数语法糖构造函数：

   ```dart
   class Book {
     String title;
     double price;
     Book({this.title = '未命名', this.price = 0});
   }
   ```

# 💯💯💯 命名构造函数

非常棒 👍
你现在学习到 Dart 构造函数的下一步 —— **命名构造函数（Named Constructor）**。
这一部分非常重要，因为它是 Dart 中实现「多种不同创建对象方式」的关键。
我们只讲最最基础的核心知识 + 经典易懂的代码。

---

## 🧭 一、命名构造函数是什么？

> 命名构造函数（Named Constructor）就是一种 **“有名字的构造函数”**，
> 用来在一个类里定义**多个不同的构造方式**。

👉 Dart 允许一个类中有多个构造函数，但每个要有不同的“名字”。

---

## 🧩 二、为什么要用命名构造函数？

有时我们希望同一个类能用不同方式创建对象，比如：

* 从普通参数创建对象
* 从 JSON 数据创建对象
* 创建一个默认空对象

命名构造函数就能解决这个问题。

---

## 🧱 三、命名构造函数的语法

```dart
class 类名 {
  类名.构造函数名(参数列表) {
    // 构造逻辑
  }
}
```

> ✅ 注意：
>
> * 名字写在类名后面，用 `.` 连接；
> * 可以定义多个命名构造函数。

---

## 📘 四、最最经典的示例：`fromJson`

```dart
class Person {
  String name;
  int age;

  // 普通构造函数
  Person(this.name, this.age);

  // 命名构造函数：从 Map 创建对象
  Person.fromJson(Map<String, dynamic> json)
      : name = json['name'],
        age = json['age'];
}

void main() {
  // 普通方式创建
  var p1 = Person('小明', 18);

  // 从 JSON（Map）创建
  var p2 = Person.fromJson({'name': '小红', 'age': 20});

  print('${p1.name} - ${p1.age}');
  print('${p2.name} - ${p2.age}');
}
```

🧠 输出：

```
小明 - 18
小红 - 20
```

✅ **知识点：**

* `Person.fromJson` 是命名构造函数。
* 用 `:` 初始化属性（这叫“初始化列表”）。
* 这样可以创建“不同来源”的对象。

---

## 🧩 五、一个类可以有多个命名构造函数

```dart
class Point {
  int x;
  int y;

  Point(this.x, this.y); // 普通构造函数

  // 命名构造函数：原点
  Point.origin()
      : x = 0,
        y = 0;

  // 命名构造函数：从字符串创建
  Point.fromString(String s)
      : x = int.parse(s.split(',')[0]),
        y = int.parse(s.split(',')[1]);
}

void main() {
  var p1 = Point(3, 4);
  var p2 = Point.origin();
  var p3 = Point.fromString('5,6');

  print('p1: (${p1.x}, ${p1.y})');
  print('p2: (${p2.x}, ${p2.y})');
  print('p3: (${p3.x}, ${p3.y})');
}
```

输出：

```
p1: (3, 4)
p2: (0, 0)
p3: (5, 6)
```

✅ **知识点：**

* 一个类可以有多个命名构造函数。
* 每个命名构造函数可以有不同逻辑。

---

## ⚙️ 六、命名构造函数的典型使用场景

| 场景         | 例子                                | 说明            |
| ---------- | --------------------------------- | ------------- |
| 从 Map 创建对象 | `Person.fromJson()`               | 常用于解析 JSON 数据 |
| 创建默认对象     | `User.empty()`                    | 提供空对象的便捷方式    |
| 不同初始化方式    | `Point.origin()`、`Point.random()` | 区分不同来源或用途     |
| 工厂模式前置     | 与 `factory` 结合实现单例或缓存             | 进阶用法          |

---

## 💡 七、简单空对象示例

```dart
class User {
  String name;
  int age;

  User(this.name, this.age);

  // 空对象
  User.empty()
      : name = '未知',
        age = 0;
}

void main() {
  var u1 = User('小李', 25);
  var u2 = User.empty();

  print('${u1.name} - ${u1.age}');
  print('${u2.name} - ${u2.age}');
}
```

输出：

```
小李 - 25
未知 - 0
```

---

## 🧠 八、小结表格

| 知识点   | 内容                                   |
| ----- | ------------------------------------ |
| 定义方式  | `ClassName.name()`                   |
| 功能    | 提供多种初始化方式                            |
| 可定义多个 | ✅ 可以在一个类中定义多个                        |
| 常见命名  | `.fromJson()`、`.empty()`、`.origin()` |
| 常配合使用 | 初始化列表（`:`）和 `factory`                |
| 是否必须有 | ❌ 可选，按需添加                            |

---

## 🧱 九、经典练习（建议动手写）

1️⃣ 创建一个 `Car` 类

* 属性：`brand`、`price`
* 写两个构造函数：

  * `Car(this.brand, this.price)`
  * `Car.empty()` → `brand = '未知'`, `price = 0`

2️⃣ 创建一个 `Student` 类

* 属性：`name`, `age`
* 命名构造函数 `Student.fromMap(Map data)` → 从 Map 初始化属性。



# 💯💯💯 初始化列表

非常好！👏
学习完 Dart 的命名构造函数，接下来你必须掌握的就是 ——
⭐ **初始化列表（Initializer List）**。

这是 Dart 构造函数里非常核心的一个基础语法，
几乎每个面向对象的 Dart 程序都会用到。

---

## 🧭 一、初始化列表是什么？

> 初始化列表是在 **构造函数体（`{}`）执行之前**，
> 用来给 **实例变量赋初值** 的一个地方。

📘 语法结构是这样的：

```dart
ClassName(参数)
    : 属性1 = 表达式1,
      属性2 = 表达式2 {
  // 构造函数体
}
```

你可以理解为：

> Dart 在“正式执行构造函数体之前”，
> 会先运行冒号 `:` 后面的初始化代码。

---

## 🧩 二、为什么要有初始化列表？

有两个主要原因：

1️⃣ **有些属性必须在对象创建时就确定**（比如 `final` 属性）。
2️⃣ **比在构造函数体中赋值更高效**。

例如：

```dart
class Person {
  final String name;

  // ❌ 错误写法
  // Person(String n) {
  //   name = n; // final 变量不能在这里赋值
  // }

  // ✅ 正确写法：用初始化列表
  Person(String n) : name = n;
}
```

---

## 📘 三、最最经典的例子

```dart
class Point {
  int x;
  int y;

  // 初始化列表：在构造体执行前就给属性赋值
  Point(int a, int b)
      : x = a,
        y = b {
    print('构造函数体执行');
  }
}

void main() {
  var p = Point(3, 4);
  print('x = ${p.x}, y = ${p.y}');
}
```

🧠 输出：

```
构造函数体执行
x = 3, y = 4
```

✅ **知识点：**

* `: x = a, y = b` 是初始化列表；
* 赋值在构造体 `{}` 执行之前；
* 通常用于初始化 `final` 或 `const` 属性。

---

## 💡 四、结合命名构造函数的经典例子

```dart
class Person {
  final String name;
  final int age;

  // 命名构造函数 + 初始化列表
  Person.fromJson(Map<String, dynamic> json)
      : name = json['name'],
        age = json['age'] {
    print('Person.fromJson 构造完成');
  }
}

void main() {
  var p = Person.fromJson({'name': '小红', 'age': 20});
  print('${p.name}, ${p.age}');
}
```

🧠 输出：

```
Person.fromJson 构造完成
小红, 20
```

✅ **知识点总结：**

* 初始化列表执行顺序在构造函数体之前；
* 常用于命名构造函数；
* 让 `final` 字段在对象创建时就获得值。

---

## ⚙️ 五、可以做简单计算或调用函数

初始化列表不仅能直接赋值，也能做简单运算：

```dart
class Rectangle {
  final int width;
  final int height;
  final int area;

  Rectangle(this.width, this.height)
      : area = width * height; // 可以计算
}

void main() {
  var rect = Rectangle(3, 5);
  print('面积: ${rect.area}');
}
```

输出：

```
面积: 15
```

✅ **说明：**

* 可以在初始化列表中使用传入参数；
* 适合做计算型初始化。

---

## 🧱 六、初始化列表 + `super`（进阶一点点）

当你的类有继承时，初始化列表还能**调用父类的构造函数**。

```dart
class Animal {
  final String name;
  Animal(this.name);
}

class Dog extends Animal {
  final int age;

  // 调用父类构造 + 初始化自己的字段
  Dog(String name, this.age) : super(name);
}

void main() {
  var d = Dog('小黑', 3);
  print('${d.name}, ${d.age}');
}
```

输出：

```
小黑, 3
```

✅ **关键点：**

* `super(name)` 也是在初始化列表阶段调用；
* 先初始化父类，再执行子类构造函数体。

---

## 🧩 七、小结表格

| 知识点  | 内容                                        |
| ---- | ----------------------------------------- |
| 语法   | `ClassName(参数) : 属性 = 表达式, 属性2 = 表达式2 {}` |
| 执行顺序 | 先执行初始化列表，再执行构造函数体                         |
| 作用   | 提前给属性赋值，尤其是 `final` 属性                    |
| 可做的事 | 直接赋值、计算、调用父类构造                            |
| 常见搭配 | 命名构造函数、`super()`、`final` 字段               |

---

## 💪 八、练习建议

请自己动手写一写下面两题（非常适合入门）：

**1️⃣ 题目：**
写一个 `User` 类，包含：

* `final String name`
* `final int age`
* 用初始化列表来给属性赋值。

**2️⃣ 题目：**
写一个 `Circle` 类，包含：

* `final double radius`
* `final double area`
* 用初始化列表计算圆面积：`area = 3.14 * radius * radius`

---

要不要我帮你接着讲下一个最常搭配的知识点：
👉 **`factory` 构造函数（工厂构造函数）**？
它经常和初始化列表、命名构造函数一起出现。


# 💯💯💯 常量构造函数

非常好 👏
你已经学到 Dart 构造函数的一个非常重要的进阶基础：
⭐ **常量构造函数（`const` constructor）**。

这个知识点其实非常简单，但非常关键，
尤其在 Flutter 开发中你会**天天见到**它（比如 `const Text('Hi')`）。

---

## 🧭 一、常量构造函数是什么？

> **常量构造函数（`const` constructor）** 是一种特殊的构造函数，
> 它用来创建 **编译时就确定不变的对象**。

也就是说：

* 对象在程序运行前就已经确定了；
* 它在内存中是唯一且不可变的；
* 所以能提高性能、节省内存。

---

## 🧩 二、语法规则（非常简单）

定义常量构造函数的语法：

```dart
class 类名 {
  final 类型 属性;
  const 类名(this.属性);
}
```

📘 重点规则：

1. 构造函数前必须加 `const`；
2. 类中所有属性必须是 `final`；
3. 创建对象时用 `const` 调用。

---

## ✅ 三、最最基础的例子

```dart
class Point {
  final int x;
  final int y;

  // 常量构造函数
  const Point(this.x, this.y);
}

void main() {
  const p1 = Point(3, 4);
  const p2 = Point(3, 4);

  print(identical(p1, p2)); // 输出：true
}
```

🧠 讲解：

* `const Point(this.x, this.y)` 表示这个类的对象可以是编译期常量；
* `p1` 和 `p2` 实际上是同一个对象（因为内容相同且都是常量）；
* Dart 会在编译期就创建好这两个对象，并指向同一个内存地址。

输出：

```
true
```

---

## 🧠 四、为什么要用常量构造函数？

| 原因            | 说明                                          |
| ------------- | ------------------------------------------- |
| 🚀 提高性能       | 对象在编译时就确定，运行时无需重新创建                         |
| 🧩 节省内存       | 相同的常量对象会复用（同一个内存地址）                         |
| 🔒 不可变        | 所有属性都是 `final`，对象内容不会被修改                    |
| 💡 Flutter中常见 | 例如：`const Text('Hello')`、`const SizedBox()` |

---

## ⚙️ 五、普通构造函数 vs 常量构造函数

| 类型     | 写法                            | 创建时机 | 是否唯一 | 是否可变              |
| ------ | ----------------------------- | ---- | ---- | ----------------- |
| 普通构造函数 | `Point(this.x, this.y)`       | 运行时  | 否    | 可以有可变属性           |
| 常量构造函数 | `const Point(this.x, this.y)` | 编译时  | 是    | 不可变，属性必须是 `final` |

---

## 💡 六、结合命名构造函数的例子

```dart
class Color {
  final int red;
  final int green;
  final int blue;

  // 常量构造函数
  const Color(this.red, this.green, this.blue);

  // 命名常量构造函数
  const Color.black() : this(0, 0, 0);
}

void main() {
  const c1 = Color(255, 255, 255);
  const c2 = Color.black();

  print('白色: ${c1.red},${c1.green},${c1.blue}');
  print('黑色: ${c2.red},${c2.green},${c2.blue}');
}
```

输出：

```
白色: 255,255,255
黑色: 0,0,0
```

✅ **知识点总结：**

* 命名构造函数也能是 `const`；
* 仍然要求所有属性都是 `final`；
* 可以在初始化列表中赋常量值。

---

## 🧱 七、你也可以用“new”和“const”的区别看看效果

```dart
class Point {
  final int x;
  final int y;
  const Point(this.x, this.y);
}

void main() {
  var a = const Point(1, 2);
  var b = const Point(1, 2);
  var c = Point(1, 2); // 没有 const

  print(identical(a, b)); // true（同一个对象）
  print(identical(a, c)); // false（运行时新建的对象）
}
```

输出：

```
true
false
```

✅ 说明：

* `const` 创建的是“编译期常量”，对象唯一；
* 普通的 `Point(1,2)` 每次都会重新创建一个新对象。

---

## 🎯 八、小结表格

| 知识点  | 内容                      |
| ---- | ----------------------- |
| 关键字  | `const`                 |
| 属性要求 | 必须全是 `final`            |
| 创建对象 | `const 对象名 = 类名(参数)`    |
| 对象特性 | 编译期固定、唯一、不可变            |
| 应用场景 | Flutter UI、固定配置、颜色、坐标点等 |

---

## 💪 九、练习题（适合入门巩固）

**题目 1：**
创建一个 `User` 类：

* 包含 `final String name`；
* 提供一个 `const` 构造函数；
* 创建两个相同的 `const User`，并比较它们是否相等。

**题目 2：**
创建一个 `const Circle` 类：

* 包含 `final double radius`；
* 提供 `const` 构造函数；
* 在 `main()` 中创建两个相同半径的 `const` 对象，看是否相同。

---

是否希望我下一步帮你讲 👉 **factory（工厂构造函数）**？
它是 Dart 构造函数体系中最后一个重要类型，而且非常常用于 **单例模式** 和 **缓存对象创建**。


# 💯💯💯 工厂构造函数
