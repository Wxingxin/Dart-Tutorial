

# ğŸ’¯ğŸ’¯ğŸ’¯ ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥ï¼Ÿ

> ### å¼‚æ­¥ç¼–ç¨‹æ€»ç»“è¡¨

| æ¦‚å¿µ                   | ç”¨é€”        | å…³é”®ç‚¹                        | ç¤ºä¾‹        |
| -------------------- | --------- | -------------------------- | --------- |
| **Future**           | å•æ¬¡å¼‚æ­¥æ“ä½œ    | `.then()`, `.catchError()` | ç½‘ç»œè¯·æ±‚ã€å»¶è¿Ÿä»»åŠ¡ |
| **async / await**    | ä¼˜é›…å†™æ³•      | `await` ç­‰å¾… Future          | å¼‚æ­¥åŒæ­¥åŒ–     |
| **Stream**           | å¤šæ¬¡å¼‚æ­¥æ•°æ®æµ   | `await for`, `.listen()`   | ç›‘å¬å®æ—¶æ•°æ®    |
| **async*** / `yield` | æ„å»º Stream | å¼‚æ­¥ç”Ÿæˆå™¨                      | å®šæ—¶å™¨ã€æ¶ˆæ¯æµ   |
| **Isolate**          | çœŸå¹¶å‘æ‰§è¡Œ     | `SendPort` / `ReceivePort` | å¤æ‚è®¡ç®—ä»»åŠ¡    |



åœ¨ Dartï¼ˆå°¤å…¶ Flutterï¼‰ä¸­ï¼Œ**ä¸»çº¿ç¨‹ï¼ˆUI çº¿ç¨‹ï¼‰è´Ÿè´£æ¸²æŸ“ç•Œé¢**ã€‚
å¦‚æœæ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ï¼‰ä¼šé˜»å¡ UI â†’ ç•Œé¢å¡é¡¿ã€‚

ğŸ”¹ å¼‚æ­¥ç¼–ç¨‹çš„ç›®æ ‡ï¼š
âœ… æå‡æ€§èƒ½
âœ… é¿å… UI é˜»å¡
âœ… è®©é•¿æ—¶é—´ä»»åŠ¡åœ¨åå°æ‰§è¡Œ

ğŸ“˜ **ç¤ºä¾‹ï¼ˆåŒæ­¥ vs å¼‚æ­¥ï¼‰**

```dart
void main() {
  print('Start');
  Future.delayed(Duration(seconds: 2), () => print('Async task done'));
  print('End');
}
```

è¾“å‡ºï¼š

```
Start
End
Async task done
```

è¯´æ˜ï¼šå¼‚æ­¥ä»»åŠ¡ä¸ä¼šé˜»å¡åç»­ä»£ç ã€‚

---

# ğŸ’¯ğŸ’¯ğŸ’¯ äºŒã€`Future`ï¼ˆæœªæ¥çš„å€¼æˆ–é”™è¯¯ï¼‰

### ğŸŒŸ åŸºæœ¬æ¦‚å¿µ

`Future` è¡¨ç¤ºä¸€ä¸ª**æœªæ¥æŸä¸ªæ—¶é—´ä¼šè¿”å›ç»“æœæˆ–é”™è¯¯**çš„å¯¹è±¡ã€‚
ç±»ä¼¼äº JavaScript ä¸­çš„ `Promise`ã€‚

---

### ğŸ“˜ åˆ›å»º Future

```dart
Future<String> fetchData() {
  return Future.delayed(Duration(seconds: 2), () => 'Data loaded');
}

void main() {
  fetchData().then((value) => print(value));
}
```

è¾“å‡ºï¼š

```
Data loaded
```

---

### ğŸ“˜ é“¾å¼è°ƒç”¨ `.then()` / `.catchError()` / `.whenComplete()`

```dart
Future<int> getNumber() {
  return Future(() => 42);
}

void main() {
  getNumber()
    .then((value) => print('Value: $value'))
    .catchError((e) => print('Error: $e'))
    .whenComplete(() => print('Done'));
}
```

è¾“å‡ºï¼š

```
Value: 42
Done
```

---

### ğŸ“˜ Future é”™è¯¯å¤„ç†

```dart
Future<void> throwError() {
  return Future.error('Something went wrong');
}

void main() {
  throwError().catchError((e) => print(e));
}
```

---

# ğŸ’¯ğŸ’¯ğŸ’¯ ä¸‰ã€`async` / `await`ï¼ˆå¼‚æ­¥è¯­æ³•ç³–ï¼‰â­ï¼ˆé‡ç‚¹ï¼‰

### ğŸŒŸ åŸºæœ¬æ¦‚å¿µ

* ç”¨ `async` æ ‡è®°å‡½æ•°ï¼›
* ç”¨ `await` ç­‰å¾… Future ç»“æœï¼›
* ä½¿å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ã€‚

```dart
Future<String> fetchData() async {
  await Future.delayed(Duration(seconds: 2));
  return 'Data received';
}

void main() async {
  print('Fetching...');
  String data = await fetchData();
  print(data);
}
```

è¾“å‡ºï¼š

```
Fetching...
Data received
```

---

### ğŸ“˜ å¼‚æ­¥å¼‚å¸¸å¤„ç†ï¼ˆæ¨è try / catchï¼‰

```dart
Future<String> fetchUser() async {
  throw Exception('User not found');
}

void main() async {
  try {
    String user = await fetchUser();
    print(user);
  } catch (e) {
    print('Caught: $e');
  }
}
```

---

# ğŸ’¯ğŸ’¯ğŸ’¯ å››ã€`Stream`ï¼ˆæ•°æ®æµï¼‰

### ğŸŒŸ åŸºæœ¬æ¦‚å¿µ

`Stream` è¡¨ç¤º**ä¸€ç³»åˆ—å¼‚æ­¥äº‹ä»¶**ï¼Œæ¯”å¦‚ä»ç½‘ç»œã€ä¼ æ„Ÿå™¨æˆ–ç”¨æˆ·è¾“å…¥æŒç»­æ¥æ”¶æ•°æ®ã€‚

ä¸ `Future` çš„åŒºåˆ«ï¼š

| Future | Stream   |
| ------ | -------- |
| åªè¿”å›ä¸€ä¸ªå€¼ | è¿”å›å¤šä¸ªå€¼ï¼ˆæµï¼‰ |
| ä¸€æ¬¡æ€§å®Œæˆ  | å¯ä»¥æŒç»­å‘å‡ºäº‹ä»¶ |

---

### ğŸ“˜ ç›‘å¬ Stream

```dart
Stream<int> numberStream() async* {
  for (int i = 1; i <= 3; i++) {
    await Future.delayed(Duration(seconds: 1));
    yield i;
  }
}

void main() async {
  await for (var num in numberStream()) {
    print(num);
  }
}
```

è¾“å‡ºï¼š

```
1
2
3
```

---

### ğŸ“˜ Stream API

```dart
Stream<int> numbers = Stream.fromIterable([1, 2, 3, 4, 5]);
numbers.where((n) => n.isEven).listen((n) => print('Even: $n'));
```

è¾“å‡ºï¼š

```
Even: 2
Even: 4
```

---

# ğŸ’¯ğŸ’¯ğŸ’¯ äº”ã€`async*` ä¸ `yield`ï¼ˆæ„å»º Streamï¼‰

* `async*`ï¼šå£°æ˜ä¸€ä¸ªè¿”å› Stream çš„å¼‚æ­¥ç”Ÿæˆå™¨ï¼›
* `yield`ï¼šå‘é€ä¸€ä¸ªå€¼ï¼›
* `yield*`ï¼šå‘é€å¦ä¸€ä¸ª Stream çš„æ‰€æœ‰å€¼ã€‚

```dart
Stream<int> countStream() async* {
  for (int i = 1; i <= 3; i++) {
    yield i;
  }
}

void main() async {
  await for (var n in countStream()) {
    print('Value: $n');
  }
}
```

è¾“å‡ºï¼š

```
Value: 1
Value: 2
Value: 3
```

---

# ğŸ’¯ğŸ’¯ğŸ’¯ å…­ã€`Isolates`ï¼ˆå¹¶å‘æ¨¡å‹ï¼‰

### ğŸŒŸ ä¸ºä»€ä¹ˆè¦ç”¨ Isolateï¼Ÿ

Dart æ²¡æœ‰ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„â€œå¤šçº¿ç¨‹å…±äº«å†…å­˜â€ï¼Œ
è€Œæ˜¯ä½¿ç”¨ **Isolateï¼ˆéš”ç¦»åŒºï¼‰** å®ç°çœŸæ­£çš„å¹¶å‘ï¼Œæ¯ä¸ª Isolate æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å’Œäº‹ä»¶å¾ªç¯ã€‚

é€šä¿¡é  `SendPort` / `ReceivePort`ã€‚

---

### ğŸ“˜ åŸºæœ¬ç¤ºä¾‹

```dart
import 'dart:isolate';

void sayHello(SendPort sendPort) {
  sendPort.send('Hello from Isolate!');
}

void main() async {
  final receivePort = ReceivePort();
  await Isolate.spawn(sayHello, receivePort.sendPort);

  receivePort.listen((message) {
    print(message);
  });
}
```

è¾“å‡ºï¼š

```
Hello from Isolate!
```

