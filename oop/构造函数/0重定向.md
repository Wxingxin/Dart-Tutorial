| 构造函数类型 | 修饰符         | 特点             | 返回       | 使用场景         |
| ------ | ----------- | -------------- | -------- | ------------ |
| 生成式    | 无           | 普通构造函数，初始化对象   | 新实例      | 普通对象创建       |
| 命名     | 无 + 自定义名字   | 提供多种初始化方式      | 新实例      | 多种初始化场景      |
| 常量     | `const`     | 不可变对象，可共享      | 编译时对象    | 不可变对象、节省内存   |
| 工厂     | `factory`   | 可以返回缓存、子类或条件实例 | 可以返回现有对象 | 单例、对象复用、复杂逻辑 |
| 重定向    | `:` + 构造函数名 | 调用同类其他构造函数     | 新实例      | 避免重复初始化逻辑    |


好的，我们来系统梳理 **Dart 的重定向构造函数（Redirecting Constructor）**，从知识点到使用大全，结合示例讲清楚。

---

# 1️⃣ 什么是重定向构造函数

**定义：**
重定向构造函数是 Dart 中一种 **构造函数调用同类中另一个构造函数** 的方式，用于 **减少重复初始化代码**。

* 语法：

```dart
ClassName.constructorName() : this.otherConstructor(arguments);
```

* 它本质上**把对象的初始化逻辑委托给另一个构造函数**。
* 重定向构造函数本身不能包含初始化列表或代码块，只能调用目标构造函数。

---

# 2️⃣ 基本语法示例

```dart
class Point {
  int x;
  int y;

  // 主构造函数
  Point(this.x, this.y);

  // 重定向构造函数
  Point.zero() : this(0, 0);  // 调用 Point(x, y)
  Point.one() : this(1, 1);
}

void main() {
  var p0 = Point.zero();
  var p1 = Point.one();
  print('${p0.x}, ${p0.y}'); // 0, 0
  print('${p1.x}, ${p1.y}'); // 1, 1
}
```

✅ 特点：

* `Point.zero()` 调用 `Point(0,0)` 初始化对象。
* 避免重复写初始化逻辑。
* 可以和命名构造函数组合使用。

---

# 3️⃣ 重定向构造函数的规则

1. **只能调用同类的构造函数**（不能调用其他类的构造函数）。
2. **不能在重定向构造函数中写额外初始化列表或构造函数体**：

   ```dart
   Point.zero() : this(0, 0) { 
     // ❌ 错误，重定向构造函数不能有代码块
   }
   ```
3. **可以调用默认构造函数或命名构造函数**：

   ```dart
   class Person {
     String name;
     int age;

     Person(this.name, this.age);
     Person.guest() : this('Guest', 0);
   }
   ```

---

# 4️⃣ 高级使用示例

## 4.1 默认值重定向

```dart
class Rectangle {
  int width;
  int height;

  Rectangle(this.width, this.height);

  // 重定向构造函数，提供默认值
  Rectangle.small() : this(10, 10);
  Rectangle.large() : this(100, 100);
}

void main() {
  var r1 = Rectangle.small();
  var r2 = Rectangle.large();
  print('${r1.width} x ${r1.height}'); // 10 x 10
  print('${r2.width} x ${r2.height}'); // 100 x 100
}
```

## 4.2 命名构造函数 + 重定向

```dart
class Person {
  String name;
  int age;

  Person(this.name, this.age);

  Person.guest() : this('Guest', 0);
  Person.admin() : this('Admin', 100);
}

void main() {
  var p1 = Person.guest();
  var p2 = Person.admin();
  print('${p1.name}, ${p1.age}'); // Guest, 0
  print('${p2.name}, ${p2.age}'); // Admin, 100
}
```

---

# 5️⃣ 使用场景大全

| 场景             | 说明                    | 示例                                   |
| -------------- | --------------------- | ------------------------------------ |
| **减少重复初始化代码**  | 多个构造函数逻辑类似，调用主构造函数初始化 | `Rectangle.small() : this(10,10)`    |
| **提供默认对象**     | 快速创建带默认值的对象           | `Person.guest() : this('Guest',0)`   |
| **命名构造函数组合使用** | 命名构造函数可以重定向到主构造函数     | `Person.admin() : this('Admin',100)` |
| **常量构造函数重定向**  | 用于不可变对象初始化            | `const Point.origin() : this(0,0);`  |

---

# 6️⃣ 注意事项

1. 重定向构造函数 **不能有自己的初始化列表或函数体**，只负责转发参数。
2. 目标构造函数可以是：

   * 主生成式构造函数
   * 命名构造函数
3. 支持常量构造函数重定向：

   ```dart
   class Point {
     final int x, y;
     const Point(this.x, this.y);
     const Point.origin() : this(0, 0);
   }
   ```

---

# 7️⃣ 总结

* **作用**：避免重复代码、提供默认初始化、便于维护。
* **特点**：构造函数直接调用类中其他构造函数；不能有自己的代码块。
* **使用场景**：

  1. 提供默认值
  2. 命名构造函数组合使用
  3. 常量对象初始化
  4. 重复逻辑封装

---

如果你愿意，我可以帮你画一张 **“Dart 构造函数调用关系图”**，把 **生成式、命名、重定向构造函数**的调用流程一眼看懂，非常直观。

你希望我画吗？
