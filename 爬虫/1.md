éå¸¸å¥½ ğŸ‘
ä½ ç°åœ¨è¦å­¦çš„æ˜¯ **Dart çš„çˆ¬è™«ï¼ˆWeb Scrapingï¼‰** â€”â€” ä¸ä¾èµ– Flutter UIï¼Œåªç”¨ **Dart è¯­è¨€æœ¬èº«** æ¥æŠ“å–å’Œè§£æç½‘é¡µå†…å®¹ã€‚

æˆ‘æ¥æ•™ä½ æœ€ç»å…¸ã€æœ€å¸¸ç”¨ã€æœ€æ¸…æ™°çš„ Dart çˆ¬è™«æ¡ˆä¾‹ï¼ˆå«è¯¦ç»†æ³¨é‡Šå’Œè¿›é˜¶æ‰©å±•ï¼‰ã€‚
æœ¬ç¯‡é€‚åˆå­¦ä¹  Dart ç½‘ç»œç¼–ç¨‹ + çˆ¬è™«æ ¸å¿ƒåŸç†ã€‚

---

## ğŸ•·ï¸ ä¸€ã€çˆ¬è™«åŸç†å›é¡¾

çˆ¬è™«ï¼ˆWeb Scrapingï¼‰çš„ä¸‰ä¸ªæ­¥éª¤ï¼š

1ï¸âƒ£ **å‘é€ HTTP è¯·æ±‚** â†’ è·å–ç½‘é¡µæºä»£ç ã€‚
2ï¸âƒ£ **è§£æ HTML å†…å®¹** â†’ æå–ç›®æ ‡æ•°æ®ã€‚
3ï¸âƒ£ **å­˜å‚¨ç»“æœ** â†’ æ‰“å°ã€ä¿å­˜æ–‡ä»¶æˆ–å†™å…¥æ•°æ®åº“ã€‚

åœ¨ Dart é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š

* `http` åŒ… â€”â€” å‘è¯·æ±‚ã€‚
* `html` åŒ… â€”â€” è§£æ HTML DOMã€‚
* `dart:io` â€”â€” å†™æ–‡ä»¶ã€‚

---

## ğŸ§° äºŒã€é¡¹ç›®ä¾èµ–

åˆ›å»ºä¸€ä¸ª Dart é¡¹ç›®ï¼š

```bash
dart create dart_spider_demo
cd dart_spider_demo
```

ç¼–è¾‘ `pubspec.yaml`ï¼š

```yaml
dependencies:
  http: ^1.2.0
  html: ^0.15.5
```

æ‰§è¡Œï¼š

```bash
dart pub get
```

---

## ğŸ’» ä¸‰ã€ç»å…¸æ¡ˆä¾‹ 1ï¼šçˆ¬å–è±†ç“£ç”µå½± Top 250

ä¿å­˜ä¸º `bin/douban_spider.dart`ï¼š

```dart
import 'package:http/http.dart' as http;
import 'package:html/parser.dart' as parser;
import 'package:html/dom.dart';

/// Dart çˆ¬è™«ç»å…¸æ¡ˆä¾‹ï¼šçˆ¬å–è±†ç“£ç”µå½± Top 250
/// åŠŸèƒ½ï¼š
/// 1ï¸âƒ£ è¯·æ±‚ç½‘é¡µ
/// 2ï¸âƒ£ æå–ç”µå½±æ ‡é¢˜å’Œè¯„åˆ†
/// 3ï¸âƒ£ æ‰“å°ç»“æœ

Future<void> main() async {
  print('å¼€å§‹çˆ¬å–è±†ç“£ç”µå½± Top 250 ...');

  // ç›®æ ‡ç½‘å€
  final url = Uri.parse('https://movie.douban.com/top250');

  // æ·»åŠ  User-Agent æ¨¡æ‹Ÿæµè§ˆå™¨è¯·æ±‚
  final response = await http.get(url, headers: {
    'User-Agent':
        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36'
  });

  // æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ
  if (response.statusCode == 200) {
    // è§£æ HTML æ–‡æœ¬
    Document document = parser.parse(response.body);

    // é€‰æ‹©æ‰€æœ‰ç”µå½±æ¡ç›®èŠ‚ç‚¹
    final movieItems = document.querySelectorAll('.item');

    for (var item in movieItems) {
      // æå–æ ‡é¢˜
      final title = item.querySelector('.title')?.text.trim() ?? 'æ— æ ‡é¢˜';
      // æå–è¯„åˆ†
      final rating = item.querySelector('.rating_num')?.text.trim() ?? 'æ— è¯„åˆ†';
      print('ğŸ¬ $title  â­ è¯„åˆ†ï¼š$rating');
    }
  } else {
    print('âŒ è¯·æ±‚å¤±è´¥ï¼š${response.statusCode}');
  }

  print('âœ… çˆ¬å–å®Œæˆï¼');
}
```

---

### ğŸ§  ä»£ç è®²è§£ï¼š

| æ­¥éª¤ | å…³é”®å‡½æ•°                                 | ä½œç”¨                |
| -- | ------------------------------------ | ----------------- |
| 1  | `http.get()`                         | å‘ç½‘é¡µå‘é€ GET è¯·æ±‚      |
| 2  | `parser.parse()`                     | å°† HTML å­—ç¬¦ä¸²è½¬æ¢ä¸º DOM |
| 3  | `document.querySelectorAll('.item')` | æŸ¥æ‰¾æ‰€æœ‰ç”µå½±é¡¹           |
| 4  | `.querySelector('.title')?.text`     | è·å–èŠ‚ç‚¹æ–‡æœ¬å†…å®¹          |
| 5  | `print()`                            | è¾“å‡ºçˆ¬å–ç»“æœ            |

---

### âœ… è¿è¡Œç»“æœç¤ºä¾‹ï¼š

```bash
dart run bin/douban_spider.dart
```

è¾“å‡ºï¼š

```
å¼€å§‹çˆ¬å–è±†ç“£ç”µå½± Top 250 ...
ğŸ¬ è‚–ç”³å…‹çš„æ•‘èµ  â­ è¯„åˆ†ï¼š9.7
ğŸ¬ éœ¸ç‹åˆ«å§¬  â­ è¯„åˆ†ï¼š9.6
ğŸ¬ é˜¿ç”˜æ­£ä¼   â­ è¯„åˆ†ï¼š9.5
ğŸ¬ ç¾ä¸½äººç”Ÿ  â­ è¯„åˆ†ï¼š9.5
...
âœ… çˆ¬å–å®Œæˆï¼
```

---

## ğŸ’¾ å››ã€æ¡ˆä¾‹ 2ï¼šçˆ¬å–å¹¶ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶

ä¿å­˜ä¸º `bin/save_to_file.dart`ï¼š

```dart
import 'dart:io';
import 'package:http/http.dart' as http;
import 'package:html/parser.dart' as parser;

Future<void> main() async {
  print('æ­£åœ¨çˆ¬å–æ–°é—»æ•°æ®...');

  final url = Uri.parse('https://news.ycombinator.com/');
  final response = await http.get(url);

  if (response.statusCode == 200) {
    final document = parser.parse(response.body);
    final titles = document.querySelectorAll('a.storylink, a.titlelink');

    final file = File('news.txt');
    final sink = file.openWrite();

    for (var i = 0; i < titles.length; i++) {
      final text = titles[i].text.trim();
      sink.writeln('ğŸ“° ${i + 1}. $text');
    }

    await sink.close();
    print('âœ… å·²ä¿å­˜åˆ° news.txt');
  } else {
    print('âŒ è¯·æ±‚å¤±è´¥ï¼š${response.statusCode}');
  }
}
```

è¿è¡Œï¼š

```bash
dart run bin/save_to_file.dart
```

è¾“å‡ºï¼š

```
âœ… å·²ä¿å­˜åˆ° news.txt
```

æ‰“å¼€ `news.txt`ï¼š

```
ğŸ“° 1. Google launches Dart 3.3
ğŸ“° 2. Flutter 4.0 stable released
ğŸ“° 3. AI startup raises $100M
...
```

---

## ğŸ•¸ï¸ äº”ã€æ¡ˆä¾‹ 3ï¼šå¤šé¡µçˆ¬å–ï¼ˆè¿›é˜¶ï¼‰

```dart
import 'package:http/http.dart' as http;
import 'package:html/parser.dart' as parser;

Future<void> main() async {
  print('çˆ¬å–è±†ç“£ç”µå½±å¤šé¡µæ•°æ®...');

  for (int page = 0; page < 3; page++) {
    final start = page * 25;
    final url = Uri.parse('https://movie.douban.com/top250?start=$start');
    final response = await http.get(url, headers: {
      'User-Agent': 'Mozilla/5.0 (compatible; DartSpider/1.0)'
    });

    if (response.statusCode == 200) {
      final document = parser.parse(response.body);
      final movies = document.querySelectorAll('.item');

      print('\nç¬¬ ${page + 1} é¡µï¼š');
      for (var item in movies) {
        final title = item.querySelector('.title')?.text.trim() ?? 'æ— æ ‡é¢˜';
        final rating = item.querySelector('.rating_num')?.text.trim() ?? 'æ— è¯„åˆ†';
        print('ğŸ¬ $title â­ $rating');
      }
    }
  }
}
```

è¿è¡Œç»“æœï¼š

```
ç¬¬ 1 é¡µï¼š
ğŸ¬ è‚–ç”³å…‹çš„æ•‘èµ â­ 9.7
ğŸ¬ éœ¸ç‹åˆ«å§¬ â­ 9.6
...

ç¬¬ 2 é¡µï¼š
ğŸ¬ è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†· â­ 9.4
ğŸ¬ æ³°å¦å°¼å…‹å· â­ 9.4
...
```

---

## âš¡ å…­ã€æ‹“å±•æ–¹å‘

| ç›®æ ‡     | å¯ç”¨æŠ€æœ¯                          |
| ------ | ----------------------------- |
| å›¾ç‰‡ä¸‹è½½   | `HttpClient().getUrl()`       |
| æ•°æ®å­˜å‚¨   | `Hive` / `MongoDB` / `SQLite` |
| å¼‚æ­¥ä»»åŠ¡æ§åˆ¶ | `Future.wait()` / `Stream`    |
| API çˆ¬å– | `jsonDecode()` è§£æ JSON        |
| é˜²åçˆ¬    | è‡ªå®šä¹‰ Header / éšæœº UA / å»¶è¿Ÿè¯·æ±‚     |

---

## ğŸ§© ä¸ƒã€æ€»ç»“

| æ¨¡å—                 | ä½œç”¨     |
| ------------------ | ------ |
| `http`             | å‘é€è¯·æ±‚   |
| `html`             | DOM è§£æ |
| `dart:io`          | æ–‡ä»¶æ“ä½œ   |
| `Future` / `await` | å¼‚æ­¥æ‰§è¡Œ   |
| `for` å¾ªç¯ + DOM     | éå†æå–å†…å®¹ |

---

æ˜¯å¦å¸Œæœ›æˆ‘æ¥ç€å¸®ä½ å†™ä¸€ä¸ª **å®Œæ•´çš„ Dart çˆ¬è™«å°é¡¹ç›®** ğŸ‘‰
åŒ…å«ï¼š

* å¤šé¡µçˆ¬å–
* æ•°æ®ä¿å­˜ä¸º JSON
* å›¾ç‰‡ä¸‹è½½
* å¹¶å‘è¯·æ±‚ä¼˜åŒ–

è¿™ä¸ªæ˜¯ Dart çˆ¬è™«çš„å®æˆ˜ç»¼åˆç‰ˆï¼Œéå¸¸ç»å…¸ã€‚
è¦æˆ‘å¸®ä½ å†™è¿™ä¸€ç‰ˆå—ï¼Ÿ
